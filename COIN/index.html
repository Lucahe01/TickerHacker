<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coinbase Global (COIN) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #0052FF; /* Coinbase Blue */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #3B82F6; /* Lighter Blue */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #F97316; /* orange-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #0052FF; /* Coinbase Blue */
            color: #FFFFFF;
            border-color: #0041CC; 
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #0052FF; /* Coinbase Blue */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-600 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #0052FF;">Coinbase Global (COIN) Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">Business Model</a>
                        <a href="#financials" class="nav-link">Financials & KPIs</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">Business Model</a>
                    <a href="#financials" class="nav-link block text-base">Financials & KPIs</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">Coinbase: Powering the Cryptoeconomy</h2>
            <p class="content-text mb-6">Coinbase Global is a leading U.S.-based financial technology company that provides an end-to-end platform for the "cryptoeconomy." Its business model is built on two pillars: a highly volatile but lucrative **Transaction** business driven by retail and institutional trading, and a rapidly growing, more stable **Subscription & Services** business. Coinbase's strategy is to be the most trusted and compliant "on-ramp" for users to access the world of digital assets, leveraging its brand and scale to attract users. The company is now expanding beyond just trading, building a foundational Layer-2 blockchain called <span class="highlight">Base</span> to encourage an ecosystem of decentralized applications that drive utility and transactions on its platform. This analysis explores Coinbase's dual revenue streams, its financial performance through the crypto cycles, and its strategic position.</p>
            
            <div class="grid md:grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Business Strategy</h3>
                    <p class="content-text mb-4">Coinbase's strategy is focused on long-term growth of the cryptoeconomy:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">Be the Most Trusted & Compliant:</strong> Differentiate itself by prioritizing security and working with regulators, making it the safest and easiest on-ramp for new users and institutions in the U.S.</li>
                        <li><strong class="font-semibold text-gray-700">Grow Stable Subscription & Services Revenue:</strong> Actively develop and promote services like Staking, Custody, and the USDC stablecoin to create a more predictable, recurring revenue base that is less dependent on trading volumes.</li>
                        <li><strong class="font-semibold text-gray-700">Drive Utility with Base:</strong> Foster a vibrant ecosystem of developers and applications on its Layer-2 blockchain, Base, to increase the use cases for crypto beyond speculation and drive on-chain transactions.</li>
                        <li><strong class="font-semibold text-gray-700">"Go Broad, Go Deep":</strong> List every digital asset that is legal and safe to do so, while also building deep, integrated services for the most important assets like Bitcoin and Ethereum.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-blue-50 border-blue-200">
                    <p class="kpi-label">Assets on Platform (Q1 2025)</p>
                    <p class="kpi-value text-blue-800">$312 Billion</p>
                    <p class="content-text text-sm mt-2">Represents the total value of customer assets held on the Coinbase platform, a key measure of its scale and market leadership.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How Coinbase Makes Money: Transactions vs. Subscriptions</h2>
            <p class="content-text mb-6">Coinbase's business is a tale of two very different revenue streams. **Transaction revenue** is generated from fees on trading activity and is highly volatile, spiking during crypto bull markets and falling sharply during "crypto winters." The strategic focus is on growing **Subscription and Services revenue**, which is more stable and recurring, providing a valuable ballast to the overall business.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="transaction">Transaction Revenue</button>
                    <button class="segment-tab-button" data-target="services">Subscription & Services</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="transactionContent" class="segment-content">
                    <h3 class="subsection-title">Transaction Revenue (The Engine)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">This is the historical core of the company and its largest revenue source. Coinbase earns a small percentage fee on the value of every trade made by its retail and institutional customers. This revenue stream is <span class="highlight">directly correlated with crypto market volatility and trading volume</span>. During bull markets when interest is high, trading volumes surge and transaction revenues explode. During bear markets, volumes plummet and this revenue stream dries up significantly.</p>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="segmentBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>
                <div id="servicesContent" class="segment-content hidden">
                    <h3 class="subsection-title">Subscription & Services Revenue (The Future)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">This is the strategic growth engine for the company. It represents a growing portfolio of more stable, recurring revenue streams that are less dependent on market volatility. Key components include:</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-2">
                                <li><strong>Staking Rewards:</strong> Fees earned for helping to secure proof-of-stake blockchains like Ethereum.</li>
                                <li><strong>Custody Fees:</strong> Fees for securely storing crypto assets for institutional clients.</li>
                                <li><strong>Interest & USDC Revenue:</strong> Interest earned on customer cash balances and revenue sharing from the USDC stablecoin.</li>
                                <li><strong>Base:</strong> Transaction fees generated from activity on its Layer-2 network.</li>
                             </ul>
                        </div>
                        <div class="kpi-card bg-blue-50 border-blue-200 p-6 flex flex-col justify-center">
                            <p class="kpi-label">Q1 2025 Subscription & Services Revenue</p>
                            <p class="kpi-value text-blue-800">$511 Million</p>
                            <p class="content-text text-sm mt-2">This high-margin, recurring revenue stream has grown for six consecutive quarters, demonstrating the success of the company's strategic pivot.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive: Riding the Crypto Cycle</h2>
            <p class="content-text mb-6">Coinbase's financial performance is a direct reflection of the "boom and bust" cycles of the cryptocurrency market. The company experiences massive revenue growth and profitability during bull markets, followed by significant revenue declines and losses during "crypto winters." The key to the investment thesis is the performance during the downturns: each cycle, the company's revenue "lows" have been higher than the previous cycle's "highs," and the subscription business provides a growing, stable floor. The charts below clearly illustrate this cyclicality.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (The Cycle)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="netRevenue" selected>Total Revenue ($B)</option>
                            <option value="netIncome">Net Income ($B)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Revenue by Type ($M)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">View:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="segmentRevenue" selected>Revenue by Type</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">The yearly chart shows the massive 2021 bull market profits followed by heavy losses in 2022. The quarterly chart highlights the volatility of transaction revenue (in blue) versus the steady, sequential growth of subscription and services revenue (in gray).</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: The Trusted On-Ramp</h2>
            <p class="content-text mb-6">In an industry often associated with scams, hacks, and regulatory uncertainty, Coinbase has built a powerful competitive moat based on trust, security, and a commitment to regulatory compliance. This has made it the go-to platform for new users and institutions, particularly in the United States.</p>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-blue-700 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Trusted Brand & Security:</strong> In the "wild west" of crypto, the Coinbase brand is synonymous with safety and ease of use. This reputation is a massive competitive advantage and a primary reason it attracts first-time crypto buyers and large institutions.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-700 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Regulatory Compliance:</strong> As a publicly-traded, U.S.-based company, Coinbase has invested heavily in being compliant with U.S. regulations. This provides a level of legitimacy and a significant barrier to entry that many offshore competitors cannot match.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-700 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Scale & Liquidity Network Effects:</strong> As a leading global exchange, Coinbase has a massive user base and high trading volumes. This deep liquidity attracts more traders and institutions, which in turn creates even more liquidity, forming a powerful network effect.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Other Centralized Exchanges:</strong> Competes with other exchanges like Kraken in the U.S. and, on a global scale, with giants like Binance, though regulatory pressures have diminished Binance's U.S. presence.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Decentralized Exchanges (DEXs):</strong> Faces growing competition from decentralized platforms like Uniswap, which allow users to trade peer-to-peer without an intermediary.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">●</span>
                             <span class="content-text"><strong class="text-gray-700">Brokerage Apps:</strong> Traditional finance companies like Robinhood and Block (Cash App) offer crypto trading, competing for retail users.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: Risks & Rewards</h2>
            <p class="content-text mb-6">The investment thesis for Coinbase is a high-risk, high-reward bet on the long-term growth and adoption of the cryptoeconomy. The rewards come from its market-leading position and its ability to monetize crypto cycles, while the risks are dominated by the inherent volatility and regulatory uncertainty of the industry itself.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities 🚀</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Leading Beneficiary of Crypto Adoption:</strong> As a primary on-ramp, Coinbase is perfectly positioned to benefit from any future bull markets and increased mainstream and institutional adoption of crypto assets.</li>
                        <li><strong>Growth of Stable Recurring Revenue:</strong> The continued growth of its high-margin Subscription and Services business is creating a more stable and predictable financial foundation for the company.</li>
                        <li><strong>The 'Base' Ecosystem:</strong> The potential success of its Layer-2 blockchain, Base, could create a powerful new ecosystem and revenue driver that is tied to utility and development rather than just speculation.</li>
                        <li><strong>Regulatory Clarity:</strong> While also a risk, the eventual establishment of a clear regulatory framework in the U.S. could de-risk the business and solidify Coinbase's leadership position.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-red-600">Risks & Challenges 📉</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Crypto Price & Volume Volatility:</strong> This is the paramount risk. The company's transaction revenue, which is still the majority of its business, is entirely dependent on the volatile and unpredictable nature of crypto markets.</li>
                        <li><strong>Regulatory Risk:</strong> This is an existential risk. An adverse regulatory crackdown, particularly from the U.S. SEC classifying many tokens as securities, could fundamentally undermine Coinbase's business model.</li>
                        <li><strong>Intense Competition & Fee Compression:</strong> The crypto exchange space is highly competitive, which could lead to long-term pressure on trading fees, similar to what occurred in the stock brokerage industry.</li>
                        <li><strong>Security Threats:</strong> As a custodian of billions of dollars in crypto assets, Coinbase is a prime target for hackers and faces constant security threats. A major breach would be catastrophic for its brand.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from Coinbase Global, Inc. public filings and credible financial news sources as of June 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (!mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = 'Inter, sans-serif';
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            blue: '#0052FF',
            gray: '#6B7280',
        };

        // Segment Breakdown Chart (Doughnut)
        const segmentBreakdownCtx = document.getElementById('segmentBreakdownChart').getContext('2d');
        new Chart(segmentBreakdownCtx, {
            type: 'doughnut',
            data: {
                labels: ['Transaction Revenue', 'Subscription & Services'],
                datasets: [{
                    label: 'FY2024 Revenue Mix',
                    data: [54, 46], // Approximate revenue %
                    backgroundColor: [CHART_COLORS.blue, CHART_COLORS.gray],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'FY2024 Revenue Mix by Type (%)' } }
            }
        });
        
        // --- FINANCIAL CHARTS LOGIC ---

        // Yearly Data Store
        const yearlyDataStore = {
            labels: ['FY21', 'FY22', 'FY23', 'FY24'],
            netRevenue: { data: [7.8, 3.1, 3.1, 4.9], label: 'Total Revenue ($B)', color: CHART_COLORS.blue },
            netIncome: { data: [3.6, -2.6, -0.1, 1.2], label: 'Net Income ($B)', color: CHART_COLORS.gray },
        };

        // Quarterly Data Store
        const quarterlyDataStore = {
            labels: ['Q2 23', 'Q3 23', 'Q4 23', 'Q1 24', 'Q2 24', 'Q3 24', 'Q4 24', 'Q1 25'],
            segmentRevenue: {
                datasets: [
                    {
                        label: 'Transaction Revenue',
                        data: [327, 346, 529, 935, 1050, 750, 650, 1100],
                        backgroundColor: CHART_COLORS.blue
                    },
                    {
                        label: 'Subscription & Services',
                        data: [334, 334, 375, 410, 442, 465, 490, 511],
                        backgroundColor: CHART_COLORS.gray
                    }
                ]
            }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createYearlyChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: [{
                        label: metricDetails.label,
                        data: metricDetails.data,
                        backgroundColor: metricDetails.color + 'BF',
                        borderColor: metricDetails.color,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: false, title: { display: true, text: metricDetails.label.split('(')[1].replace(')','')} } },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function createQuarterlyChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: metricDetails.datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { 
                        x: { stacked: true },
                        y: { stacked: true, title: { display: true, text: 'Revenue ($M)'} } 
                    },
                    plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Quarterly Revenue by Type ($M)' } }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createYearlyChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createQuarterlyChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createYearlyChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'netRevenue');
        quarterlyChart = createQuarterlyChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'segmentRevenue');

    </script>
</body>
</html>

