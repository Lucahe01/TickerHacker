<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Coterra Energy Inc. (CTRA) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #A78BFA; /* violet-400 */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #7DD3FC; /* sky-400 */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #F97316; /* orange-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
            border-color: #8B5CF6; /* violet-500 */
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-500 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #A78BFA;">Coterra Energy (CTRA) Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">Business Model</a>
                        <a href="#financials" class="nav-link">Financials</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-violet-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">Business Model</a>
                    <a href="#financials" class="nav-link block text-base">Financials</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">Coterra Energy: A Diversified U.S. Energy Producer</h2>
            <p class="content-text mb-6">Coterra Energy Inc. (NYSE: CTRA) is a premier, diversified energy company engaged in the development, exploration, and production of oil, natural gas, and natural gas liquids (NGLs). Formed through the merger of Cabot Oil & Gas and Cimarex Energy, Coterra boasts a high-quality, low-cost asset base spread across three major U.S. basins: the Permian Basin (oil), the Marcellus Shale (natural gas), and the Anadarko Basin. This diversification is the cornerstone of the company's strategy, providing flexibility to allocate capital and navigate the volatile cycles of the energy market. This analysis explores Coterra's business model, its financial performance, and its strategic position as a returns-focused energy producer.</p>
            
            <div class="grid md:grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Business Strategy</h3>
                    <p class="content-text mb-4">Coterra's strategy is built on flexibility and disciplined returns:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">Commodity Diversification:</strong> Leveraging its asset base to shift capital between oil and natural gas projects based on which commodity offers superior returns at any given time.</li>
                        <li><strong class="font-semibold text-gray-700">Free Cash Flow Generation:</strong> A primary focus on generating substantial free cash flow through disciplined capital spending and operational efficiency.</li>
                        <li><strong class="font-semibold text-gray-700">Shareholder Returns:</strong> A commitment to returning a significant portion (at least 50%) of annual free cash flow to shareholders through a combination of a base dividend and share repurchases.</li>
                        <li><strong class="font-semibold text-gray-700">Operational Excellence:</strong> A culture of continuous improvement in drilling and completion techniques to lower costs and enhance well productivity.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-violet-50 border-violet-200">
                    <p class="kpi-label">2025E Free Cash Flow</p>
                    <p class="kpi-value text-violet-600">~$2.1 Billion</p>
                    <p class="content-text text-sm mt-2">This strong projected free cash flow underpins the company's ability to fund its capital program and deliver on its robust shareholder return framework.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How Coterra Makes Money: A Tale of Three Basins</h2>
            <p class="content-text mb-6">Coterra's business is a pure-play exploration and production (E&P) model. Its revenue is generated from the sale of crude oil, natural gas, and NGLs produced from its assets in the Permian Basin, the Marcellus Shale, and the Anadarko Basin. The company's unique diversification across these basins allows it to optimize its production and capital allocation based on commodity price dynamics.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="permian">Permian Basin</button>
                    <button class="segment-tab-button" data-target="marcellus">Marcellus Shale</button>
                    <button class="segment-tab-button" data-target="anadarko">Anadarko Basin</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="permianContent" class="segment-content">
                    <h3 class="subsection-title">Permian Basin (Oil-Focused)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">This is Coterra's primary oil-producing asset, located in the Delaware Basin portion of the Permian. This region provides high-margin oil production and a deep inventory of future drilling locations. Recent acquisitions have further strengthened the company's position in this key basin.</p>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="productionMixChart"></canvas>
                        </div>
                    </div>
                </div>
                <div id="marcellusContent" class="segment-content hidden">
                    <h3 class="subsection-title">Marcellus Shale (Gas-Focused)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">Located in northeast Pennsylvania, the Marcellus Shale is the largest natural gas field in the United States. Coterra holds a premier, low-cost position in this basin, allowing it to generate significant cash flow from natural gas production, particularly when gas prices are strong.</p>
                        </div>
                        <div class="kpi-card bg-sky-50 border-sky-200">
                             <p class="kpi-label">Strategic Flexibility</p>
                             <p class="kpi-value text-sky-600">Counter-Cyclical Investment</p>
                             <p class="content-text text-sm mt-2">The Marcellus asset allows Coterra to increase investment in natural gas when oil prices are low, and vice versa, providing a unique hedge against commodity volatility.</p>
                         </div>
                    </div>
                </div>
                 <div id="anadarkoContent" class="segment-content hidden">
                    <h3 class="subsection-title">Anadarko Basin</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">Located in Oklahoma, the Anadarko Basin provides an additional source of oil, natural gas, and NGLs. While not the primary focus of capital allocation, it offers further diversification and a stable production base.</p>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="revenueBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive</h2>
            <p class="content-text mb-6">Coterra's financial performance is directly tied to the volatile prices of oil and natural gas. The company's revenue and profitability soared during the commodity price spike of 2022 and have since moderated. Despite this volatility, Coterra has consistently generated strong free cash flow, which is the cornerstone of its financial strategy and shareholder return program.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (2021-2024)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                            <option value="totalRevenue" selected>Total Revenue ($B)</option>
                            <option value="netIncome">Net Income ($B)</option>
                            <option value="operatingCashFlow">Operating Cash Flow ($B)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Trends (Recent 8 Qtrs)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Quarterly Metric:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                             <option value="totalRevenue" selected>Total Revenue ($M)</option>
                             <option value="netIncome">Net Income ($M)</option>
                             <option value="freeCashFlow">Free Cash Flow ($M)</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">The financial charts clearly show the cyclical nature of the business, with revenue and net income closely tracking commodity prices. The company's ability to generate strong cash flow across the cycle is a key strength.</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: The Power of Diversification</h2>
            <p class="content-text mb-6">Coterra's key competitive advantage is its unique portfolio of top-tier assets across both oil and natural gas basins. This diversification, combined with a strong balance sheet and a culture of operational excellence, provides a durable moat in the cyclical energy industry.</p>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Commodity & Asset Diversification:</strong> The ability to allocate capital to either oil (Permian) or natural gas (Marcellus) projects, depending on which offers better returns, provides a unique strategic flexibility that pure-play competitors lack.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Low-Cost Asset Base:</strong> Coterra's assets are located in the core of the most economic oil and gas plays in the U.S., allowing the company to be profitable at lower commodity prices than many of its peers.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Fortress Balance Sheet:</strong> A commitment to maintaining low leverage provides the company with financial stability and the flexibility to be opportunistic during downturns.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Diversified E&Ps:</strong> Other large, diversified U.S. E&P companies like EOG Resources and Devon Energy.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Permian-Focused E&Ps:</strong> Companies that are pure-plays in the Permian Basin, such as Diamondback Energy and Pioneer Natural Resources (now part of ExxonMobil).</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Appalachian Gas Producers:</strong> In the Marcellus, Coterra competes with natural gas-focused companies like EQT Corporation and Range Resources.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: Risks & Rewards</h2>
            <p class="content-text mb-6">Coterra Energy offers a unique investment proposition in the energy sector: a diversified, low-cost producer with a strong balance sheet and a commitment to shareholder returns. However, the company is still subject to the inherent volatility of commodity markets.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities 🚀</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Flexible Capital Allocation:</strong> The ability to pivot between oil and gas development provides a significant advantage in navigating commodity price cycles.</li>
                        <li><strong>Strong Shareholder Returns:</strong> The commitment to return over 50% of free cash flow to shareholders provides a compelling and durable return profile.</li>
                        <li><strong>Attractive Valuation:</strong> The stock often trades at a discount to more oil-focused peers, offering a potential value opportunity.</li>
                        <li><strong>Potential for Natural Gas Price Recovery:</strong> A recovery in U.S. natural gas prices, driven by LNG export growth, would be a major tailwind for the Marcellus business.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-orange-600">Risks & Challenges 📉</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Commodity Price Volatility:</strong> The single biggest risk is a sharp and sustained decline in oil and/or natural gas prices, which would directly impact revenue, cash flow, and shareholder returns.</li>
                        <li><strong>Operational Risks:</strong> The E&P business involves inherent operational risks, including drilling challenges and well performance uncertainty.</li>
                        <li><strong>Regulatory & Environmental Scrutiny:</strong> The oil and gas industry faces ongoing pressure and regulation related to climate change, emissions, and hydraulic fracturing.</li>
                        <li><strong>Hedging Risk:</strong> While the company uses derivatives to hedge some of its production, these hedges can limit the upside potential if prices rise sharply.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from Coterra Energy Inc. public filings (SEC 10-K & 10-Q reports) and credible financial data providers as of June 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (mobileMenuEl && !mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = 'Inter, sans-serif';
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            violet: '#A78BFA',
            sky: '#7DD3FC',
            orange: '#FDBA74',
            stone: '#E7E5E4',
            gray: '#4B5563',
            darkViolet: '#8B5CF6',
            darkSky: '#38BDF8',
            teal: '#5EEAD4'
        };

        // Production Mix Chart
        const productionMixCtx = document.getElementById('productionMixChart').getContext('2d');
        new Chart(productionMixCtx, {
            type: 'doughnut',
            data: {
                labels: ['Natural Gas (MMcf/d)', 'Oil (MBbl/d)', 'NGLs (MBbl/d)'],
                datasets: [{
                    data: [3044, 141, 98], // Q1 2025 data (Gas converted to BOE for visual only)
                    backgroundColor: [CHART_COLORS.sky, CHART_COLORS.violet, CHART_COLORS.teal],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Production Mix by Volume (Q1 2025)' } }
            }
        });

        // Revenue Breakdown Chart
        const revenueBreakdownCtx = document.getElementById('revenueBreakdownChart').getContext('2d');
        new Chart(revenueBreakdownCtx, {
            type: 'pie',
            data: {
                labels: ['Natural Gas', 'Crude Oil', 'NGLs'],
                datasets: [{
                    data: [52, 38, 10], // Approximate percentages
                    backgroundColor: [CHART_COLORS.sky, CHART_COLORS.violet, CHART_COLORS.teal],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Revenue by Commodity (Illustrative)' } }
            }
        });

        // --- FINANCIAL CHARTS LOGIC ---

        // Yearly Data Store
        const yearlyDataStore = {
            labels: ['FY21', 'FY22', 'FY23', 'FY24'],
            totalRevenue: { data: [3.45, 9.05, 5.91, 5.46], label: 'Total Revenue ($B)', color: CHART_COLORS.violet },
            netIncome: { data: [1.16, 4.07, 1.63, 1.12], label: 'Net Income ($B)', color: CHART_COLORS.sky },
            operatingCashFlow: { data: [2.51, 6.01, 3.12, 2.80], label: 'Operating Cash Flow ($B)', color: CHART_COLORS.teal }
        };

        // Quarterly Data Store
        const quarterlyDataStore = {
            labels: ['Q2 23', 'Q3 23', 'Q4 23', 'Q1 24', 'Q2 24', 'Q3 24', 'Q4 24', 'Q1 25'],
            totalRevenue: { data: [1220, 1260, 1300, 1420, 1350, 1380, 1400, 1904], label: 'Total Revenue ($M)', color: CHART_COLORS.violet },
            netIncome: { data: [256, 320, 350, 420, 310, 340, 360, 516], label: 'Net Income ($M)', color: CHART_COLORS.sky },
            freeCashFlow: { data: [230, 290, 320, 450, 200, 250, 280, 600], label: 'Free Cash Flow ($M)', color: CHART_COLORS.orange }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            const isLineChart = metricKey === 'operatingCashFlow' || metricKey === 'freeCashFlow';

            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: [{
                        label: metricDetails.label,
                        data: metricDetails.data,
                        backgroundColor: isLineChart ? 'transparent' : metricDetails.color + 'BF',
                        borderColor: metricDetails.color,
                        borderWidth: 2,
                        type: isLineChart ? 'line' : 'bar',
                        fill: !isLineChart,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { 
                        y: { 
                            beginAtZero: false, 
                            title: { display: true, text: metricDetails.label.split('(')[1].replace(')','') }
                        } 
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'totalRevenue');
        quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'totalRevenue');

    </script>
</body>
</html>

