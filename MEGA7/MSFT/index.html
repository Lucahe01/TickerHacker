<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft Corp. (MSFT) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #A78BFA; /* violet-400 */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #7DD3FC; /* sky-400 */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #F97316; /* orange-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
            border-color: #8B5CF6; /* violet-500 */
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-500 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #A78BFA;">Microsoft (MSFT) Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">Business Segments</a>
                        <a href="#financials" class="nav-link">Financials</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-violet-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">Business Segments</a>
                    <a href="#financials" class="nav-link block text-base">Financials</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">Microsoft: The Enterprise AI Powerhouse</h2>
            <p class="content-text mb-6">Microsoft (NASDAQ: MSFT) is a global technology titan that has successfully transformed itself into a dominant "cloud-first, AI-first" enterprise. Its business spans a vast and powerful ecosystem of software and services, from the Azure cloud platform and the Office 365 productivity suite to the Windows operating system and the Xbox gaming division. Through its deep strategic partnership with OpenAI and the aggressive integration of <span class="highlight">Copilot AI assistants</span> across its entire product stack, Microsoft has seized a leadership position in the generative AI revolution. This positions the company to drive the next wave of productivity for businesses and consumers worldwide, solidifying its role as an indispensable technology partner for the modern era.</p>
            
            <div class="grid md-grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Strategy: AI-Powered Cloud and Productivity</h3>
                    <p class="content-text mb-4">Under CEO Satya Nadella, Microsoft's strategy is laser-focused on several key pillars:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">Lead the AI Platform Shift:</strong> Leverage its partnership with OpenAI to make Azure the premier cloud for building, training, and deploying AI models at scale.</li>
                        <li><strong class="font-semibold text-gray-700">Infuse AI Across the Portfolio:</strong> Integrate Copilot AI assistants into all major products (Windows, Office, Teams, GitHub) to create a new, high-value subscription tier and drive user productivity.</li>
                        <li><strong class="font-semibold text-gray-700">Win the Enterprise Cloud:</strong> Continue to take share in the cloud infrastructure market by offering a comprehensive, integrated stack of IaaS, PaaS, and SaaS solutions.</li>
                        <li><strong class="font-semibold text-gray-700">Grow the Gaming Ecosystem:</strong> Expand its Xbox and PC gaming footprint, particularly through its Game Pass subscription service and major content acquisitions like Activision Blizzard.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-violet-50 border-violet-200">
                    <p class="kpi-label">Microsoft Cloud Revenue (FY 2025)</p>
                    <p class="kpi-value text-violet-600">$153 Billion</p>
                    <p class="content-text text-sm mt-2">Represents 24% year-over-year growth, highlighting the massive scale and continued powerful momentum of Microsoft's cloud-centric business model.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How Microsoft Makes Money: Three Diversified Engines</h2>
            <p class="content-text mb-6">Microsoft's business is organized into three large, diversified, and highly profitable segments. The Intelligent Cloud segment, centered on Azure, has become the primary growth engine. However, the legacy Productivity and Personal Computing segments remain massive, cash-generating businesses that provide a stable foundation and a powerful distribution channel for new innovations like AI.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="cloud">Intelligent Cloud</button>
                    <button class="segment-tab-button" data-target="productivity">Productivity & Business Processes</button>
                    <button class="segment-tab-button" data-target="computing">More Personal Computing</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="cloudContent" class="segment-content">
                    <h3 class="subsection-title">Intelligent Cloud (~44% of Revenue)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">The primary growth engine of the company. This segment is anchored by Microsoft Azure, the second-largest cloud infrastructure platform in the world. It provides a vast array of services, including compute, storage, databases, and, most importantly, cutting-edge AI services that are driving a new wave of adoption.</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Products:</strong> Microsoft Azure, SQL Server, Windows Server, GitHub.</li>
                             </ul>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="revenueBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>
                <div id="productivityContent" class="segment-content hidden">
                    <h3 class="subsection-title">Productivity & Business Processes (~34% of Revenue)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">This segment contains Microsoft's iconic enterprise and consumer software suites. It is dominated by the Office 365 franchise, which includes essential applications like Word, Excel, PowerPoint, and the Teams collaboration platform. The introduction of Copilot for Microsoft 365 is a major catalyst for growth in this segment.</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Products:</strong> Microsoft Office 365 (Commercial and Consumer), Dynamics 365, LinkedIn.</li>
                             </ul>
                        </div>
                         <div class="kpi-card bg-sky-50 border-sky-200">
                             <p class="kpi-label">Key Growth Driver</p>
                             <p class="kpi-value text-sky-600">Copilot for M365</p>
                             <p class="content-text text-sm mt-2">The AI assistant for Office represents a significant opportunity to upsell existing customers to a new, premium subscription tier.</p>
                         </div>
                    </div>
                </div>
                 <div id="computingContent" class="segment-content hidden">
                    <h3 class="subsection-title">More Personal Computing (~22% of Revenue)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">This segment contains Microsoft's most consumer-facing businesses, anchored by the Windows operating system. It also includes the Xbox gaming division, which has been significantly expanded by the acquisition of Activision Blizzard, and the Surface line of hardware devices.</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Products:</strong> Windows OEM and commercial, Xbox content and services, Search and news advertising, Surface devices.</li>
                             </ul>
                        </div>
                         <div class="kpi-card bg-teal-50 border-teal-200">
                             <p class="kpi-label">Gaming Expansion</p>
                             <p class="kpi-value text-teal-600">Activision Blizzard</p>
                             <p class="content-text text-sm mt-2">The acquisition of major gaming franchises like Call of Duty and World of Warcraft has made Microsoft a dominant force in the gaming industry.</p>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive</h2>
            <p class="content-text mb-6">Microsoft's financial profile is a model of strength and consistency. The company delivers durable, double-digit revenue growth at a massive scale, combined with best-in-class profitability and enormous free cash flow generation. The rapid growth of the high-margin Intelligent Cloud segment continues to drive overall margin expansion and fund the company's significant investments in AI.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (FY23-FY25)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                            <option value="totalRevenue" selected>Total Revenue ($B)</option>
                            <option value="operatingIncome">Operating Income ($B)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Trends (Recent 8 Qtrs)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Quarterly Metric:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                             <option value="totalRevenue" selected>Total Revenue ($B)</option>
                             <option value="operatingIncome">Operating Income ($B)</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">The financial charts showcase a business that consistently delivers strong growth and exceptional profitability at a scale that is nearly unmatched in the corporate world.</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: The Enterprise Fortress</h2>
            <p class="content-text mb-6">Microsoft has built one of the most powerful and durable competitive moats in the business world. It is a multi-faceted fortress built on its massive enterprise distribution channel, a deeply integrated software stack, and powerful network effects.</p>
            
            <div class="grid md-grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Enterprise Distribution Channel:</strong> Microsoft's long-standing relationships with virtually every large enterprise CIO in the world provide a massive and unparalleled distribution channel. This allows it to effectively bundle and sell new products (like Azure and Copilot) into its existing customer base.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Integrated Software Stack & High Switching Costs:</strong> Microsoft offers an end-to-end stack of mission-critical enterprise software (Windows, Office, Azure, Dynamics). The deep integration between these products and workflows creates extremely high switching costs.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Hybrid Cloud Leadership:</strong> Azure's strong hybrid cloud capabilities, which allow companies to seamlessly manage both on-premise and public cloud environments, are a key differentiator and leverage Microsoft's legacy strength in the data center.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Amazon (AWS) & Google (GCP):</strong> The primary competitors to Microsoft Azure in the crucial cloud computing market.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Apple:</strong> A major competitor in personal computing (Mac vs. Windows) and consumer ecosystems.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Salesforce, Oracle, SAP:</strong> Key competitors in business applications (Dynamics vs. Salesforce CRM, etc.).</span>
                         </li>
                         <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Sony & Nintendo:</strong> Primary competitors to Xbox in the gaming industry.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: Risks & Rewards</h2>
            <p class="content-text mb-6">Microsoft is a blue-chip technology giant that has successfully positioned itself at the forefront of the AI revolution. The investment thesis is centered on the massive growth opportunity in its Intelligent Cloud segment and its unique ability to monetize generative AI across its vast software ecosystem. However, its immense size and success make it a prime target for regulatory scrutiny and intense competition.</p>
            <div class="grid md-grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities 🚀</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>The AI Supercycle:</strong> Microsoft is arguably the best-positioned company to benefit from the enterprise adoption of generative AI, with a leading cloud platform (Azure OpenAI) and a clear monetization strategy (Copilot).</li>
                        <li><strong>Durable Cloud Growth:</strong> The ongoing migration of enterprise workloads to the cloud provides a massive, multi-year tailwind for the high-margin Azure business.</li>
                        <li><strong>Unmatched Distribution:</strong> The company's massive enterprise salesforce and partner channel provide a durable competitive advantage that allows it to effectively cross-sell its entire portfolio.</li>
                        <li><strong>Exceptional Financial Strength:</strong> A fortress balance sheet, massive cash flow, and a commitment to capital returns provide both stability and shareholder value.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-orange-600">Risks & Challenges 📉</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Regulatory Scrutiny:</strong> As one of the world's most powerful technology companies, Microsoft faces significant and growing antitrust pressure globally, which could impact its business practices and future acquisitions.</li>
                        <li><strong>Intense Competition:</strong> The company faces formidable, well-funded competition on all fronts, particularly from Amazon and Google in the crucial cloud AI market.</li>
                        <li><strong>Execution of AI Strategy:</strong> The success of the Copilot strategy depends on demonstrating a clear return on investment for customers. Failure to do so could slow adoption of this key growth driver.</li>
                        <li><strong>Law of Large Numbers:</strong> As a multi-trillion dollar company, maintaining a high growth rate becomes increasingly difficult over time.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from Microsoft Corporation public filings (SEC reports), press releases, and credible financial data providers as of July 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (mobileMenuEl && !mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            violet: '#A78BFA',
            sky: '#7DD3FC',
            orange: '#FDBA74',
            teal: '#5EEAD4'
        };

        // Revenue Breakdown Chart
        const revenueBreakdownCtx = document.getElementById('revenueBreakdownChart').getContext('2d');
        new Chart(revenueBreakdownCtx, {
            type: 'doughnut',
            data: {
                labels: ['Intelligent Cloud', 'Productivity & Business Processes', 'More Personal Computing'],
                datasets: [{
                    data: [44, 34, 22], // Approximate percentages for FY 2025
                    backgroundColor: [CHART_COLORS.sky, CHART_COLORS.violet, CHART_COLORS.teal],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Revenue by Segment (FY25)' } }
            }
        });

        // --- FINANCIAL CHARTS LOGIC ---

        // Fiscal Year ends June 30
        const yearlyDataStore = {
            labels: ['FY23', 'FY24', 'FY25'],
            totalRevenue: {
                datasets: [ { label: 'Total Revenue ($B)', data: [211.92, 236.58, 258.84], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet } ],
                yAxisLabel: 'Billions of USD'
            },
            operatingIncome: {
                datasets: [ { label: 'Operating Income ($B)', data: [88.52, 102.06, 114.34], backgroundColor: CHART_COLORS.sky + 'BF', borderColor: CHART_COLORS.sky } ],
                yAxisLabel: 'Billions of USD'
            }
        };

        // Quarters are fiscal quarters
        const quarterlyDataStore = {
            labels: ['Q1 24', 'Q2 24', 'Q3 24', 'Q4 24', 'Q1 25', 'Q2 25', 'Q3 25', 'Q4 25'],
            totalRevenue: {
                datasets: [ { label: 'Total Revenue ($B)', data: [56.52, 62.02, 61.86, 64.95, 61.27, 66.82, 68.01, 71.55], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet } ],
                yAxisLabel: 'Billions of USD'
            },
            operatingIncome: {
                datasets: [ { label: 'Operating Income ($B)', data: [26.90, 27.05, 27.57, 25.47, 26.83, 29.80, 29.98, 32.70], backgroundColor: CHART_COLORS.teal + 'BF', borderColor: CHART_COLORS.teal } ],
                yAxisLabel: 'Billions of USD'
            }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: metricDetails.datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                           display: false
                        }
                    },
                    scales: {
                        x: {},
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: metricDetails.yAxisLabel
                            },
                        }
                    }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'totalRevenue');
        quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'totalRevenue');

    </script>
</body>
</html>

