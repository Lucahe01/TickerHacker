<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MongoDB (MDB) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #A78BFA; /* violet-400 */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #7DD3FC; /* sky-400 */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #F97316; /* orange-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
            border-color: #8B5CF6; /* violet-500 */
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-500 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #A78BFA;">MongoDB (MDB) Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">Business Model</a>
                        <a href="#financials" class="nav-link">Financials</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-violet-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">Business Model</a>
                    <a href="#financials" class="nav-link block text-base">Financials</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">MongoDB: The Developer's Data Platform</h2>
            <p class="content-text mb-6">MongoDB (NASDAQ: MDB) is a leading modern, general-purpose database platform designed to empower developers and the applications they build. The company's core innovation is its flexible, <span class="highlight">document-based data model</span>, which has become the de facto standard for modern application development, especially in the cloud. MongoDB's flagship offering, Atlas, is a fully managed, multi-cloud Database-as-a-Service (DBaaS) that has become the primary engine of the company's hyper-growth. By focusing relentlessly on developer experience and expanding its platform to include adjacent services like search and analytics, MongoDB is positioning itself as the foundational data layer for the next generation of software.</p>
            
            <div class="grid md-grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Strategy: Winning the Developer's Heart and Mind</h3>
                    <p class="content-text mb-4">MongoDB's strategy is a masterclass in a developer-first, product-led growth model:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">Lead with a Superior Product:</strong> Build the best, most intuitive data platform for developers, centered on the flexible document model that aligns with how developers think and code.</li>
                        <li><strong class="font-semibold text-gray-700">Drive Atlas Adoption:</strong> Make it incredibly easy for developers to start building on the fully managed Atlas cloud platform, leveraging a consumption-based model that allows customers to start small and grow.</li>
                        <li><strong class="font-semibold text-gray-700">Expand Beyond the Core Database:</strong> Evolve Atlas from a simple database into a comprehensive developer data platform, adding integrated services like Atlas Search, Vector Search (for AI), and Stream Processing.</li>
                        <li><strong class="font-semibold text-gray-700">Multi-Cloud and Hybrid Strategy:</strong> Give customers the flexibility to run their applications anywhere—on all major cloud providers (AWS, Azure, Google Cloud) or in their own data centers with Enterprise Advanced.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-violet-50 border-violet-200">
                    <p class="kpi-label">Atlas Revenue Contribution (Q1 FY26)</p>
                    <p class="kpi-value text-violet-600">69%</p>
                    <p class="content-text text-sm mt-2">Highlights the overwhelming success of MongoDB's cloud-first strategy, with the high-growth, consumption-based Atlas platform now making up the vast majority of the business.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How MongoDB Makes Money: A Tale of Two Offerings</h2>
            <p class="content-text mb-6">MongoDB's business model is primarily driven by its cloud offering, Atlas, which operates on a consumption-based model. This is complemented by its traditional Enterprise Advanced offering for customers who need to run MongoDB in their own data centers. This dual approach allows the company to capture the entire spectrum of the market.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="atlas">MongoDB Atlas (Cloud)</button>
                    <button class="segment-tab-button" data-target="enterprise">Enterprise Advanced (Self-Hosted)</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="atlasContent" class="segment-content">
                    <h3 class="subsection-title">MongoDB Atlas (Database-as-a-Service)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">Atlas is the flagship product and the primary growth engine. It is a fully managed, global cloud database service that automates the complex and time-consuming tasks of database administration. Revenue is generated on a consumption basis, where customers pay for what they use, allowing for a frictionless "land-and-expand" motion.</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Feature:</strong> Multi-cloud flexibility, allowing customers to deploy on AWS, Azure, or Google Cloud without being locked into a single vendor.</li>
                                <li><strong>Growth Driver:</strong> The ease of use and low barrier to entry attract a massive number of developers, who then scale their usage as their applications become successful.</li>
                             </ul>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="revenueBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>
                <div id="enterpriseContent" class="segment-content hidden">
                    <h3 class="subsection-title">MongoDB Enterprise Advanced</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">This offering is for large, sophisticated enterprise customers who require the flexibility and control of running MongoDB on their own infrastructure, whether in a private cloud or a traditional data center. Revenue is generated through term-based subscription licenses.</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Features:</strong> Advanced security controls, enterprise-grade management tools, and commercial support.</li>
                                <li><strong>Strategic Importance:</strong> Caters to the needs of large enterprises in highly regulated industries (like finance and healthcare) that may have restrictions on public cloud usage.</li>
                             </ul>
                        </div>
                         <div class="kpi-card bg-sky-50 border-sky-200">
                             <p class="kpi-label">Customer Base</p>
                             <p class="kpi-value text-sky-600">48,000+ Customers</p>
                             <p class="content-text text-sm mt-2">A massive and growing customer base, with over 1,700 customers spending more than $100,000 annually, showcasing successful enterprise adoption.</p>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive</h2>
            <p class="content-text mb-6">MongoDB has a track record of impressive, high-growth financial performance, driven by the rapid adoption of its Atlas platform. While the company has historically invested heavily in growth, it has recently demonstrated significant operating leverage, achieving non-GAAP profitability and positive free cash flow. However, recent results have shown a deceleration in growth, reflecting macroeconomic headwinds.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (FY23-FY25)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                            <option value="totalRevenue" selected>Total Revenue ($B)</option>
                            <option value="operatingIncome">Non-GAAP Operating Income ($M)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Trends (Recent 8 Qtrs)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Quarterly Metric:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                             <option value="totalRevenue" selected>Total Revenue ($M)</option>
                             <option value="operatingIncome">Non-GAAP Operating Income ($M)</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">The financial charts showcase strong historical growth, but also highlight the recent moderation in the growth rate as the business scales and faces a tougher macro environment.</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: Winning Developer Mindshare</h2>
            <p class="content-text mb-6">MongoDB's competitive advantage is built on its leadership position in the NoSQL database market, its strong brand among developers, and the powerful network effects of its cloud platform.</p>
            
            <div class="grid md-grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Developer Mindshare & The Document Model:</strong> MongoDB's document architecture is incredibly intuitive for developers, making it the go-to choice for building modern applications. This strong developer loyalty creates a powerful grassroots adoption engine that is difficult for competitors to overcome.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">High Switching Costs:</strong> Databases are the foundational layer of an application. Once an application is built on MongoDB, migrating the data, rewriting the application code, and retraining developers to use a different database is a costly and risky proposition.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Platform Network Effects:</strong> As MongoDB adds more capabilities to the Atlas platform (Search, Vector Search for AI, etc.), it becomes a more comprehensive and integrated solution. This makes it more compelling for customers to consolidate their data workloads on Atlas rather than using separate point solutions.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Cloud Hyperscalers (AWS, Microsoft, Google):</strong> The largest cloud providers offer their own competing NoSQL databases (e.g., Amazon DynamoDB, Azure Cosmos DB). They represent the most significant competitive threat due to their scale and ability to bundle services.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Legacy Relational Databases (Oracle, Microsoft SQL Server):</strong> The giants of the legacy database market. While MongoDB is taking share from them in new application development, they remain deeply entrenched in the enterprise.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Other NoSQL & NewSQL Databases:</strong> Companies like DataStax (Cassandra) and Couchbase offer other types of NoSQL databases, while companies like Cockroach Labs and PlanetScale offer next-generation relational databases.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: Risks & Rewards</h2>
            <p class="content-text mb-6">MongoDB is a best-in-class software company that has established itself as a leader in the massive and growing database market. The investment thesis is centered on its continued leadership with developers and its ability to expand the Atlas platform. However, the company is facing slowing growth and intense competition, which has put pressure on its premium valuation.</p>
            <div class="grid md-grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities 🚀</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Durable Growth in a Massive Market:</strong> The database market is one of the largest and most critical segments of enterprise software. As a leader in the modern, NoSQL portion of the market, MongoDB has a long runway for growth.</li>
                        <li><strong>The AI Tail-wind:</strong> The rise of AI and large language models (LLMs) requires powerful, scalable databases to store and process the vast amounts of unstructured data used in these applications. MongoDB's new Vector Search capabilities position it well to capture this demand.</li>
                        <li><strong>Platform Expansion:</strong> By successfully cross-selling new platform services like Search and Stream Processing, MongoDB can significantly increase its average revenue per customer and deepen its competitive moat.</li>
                        <li><strong>Improving Profitability:</strong> The company has demonstrated a strong ability to generate operating leverage and free cash flow as it scales, showcasing a powerful and efficient business model.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-orange-600">Risks & Challenges 📉</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Slowing Growth:</strong> Recent financial results and guidance have indicated a marked slowdown in the growth of the Atlas consumption business, raising concerns about the company's near-term growth trajectory.</li>
                        <li><strong>Intense Competition from Hyperscalers:</strong> The major cloud providers are formidable competitors with massive scale and the ability to deeply integrate their own database offerings into their platforms, putting pressure on MongoDB.</li>
                        <li><strong>High Valuation:</strong> Despite a recent pullback, MongoDB's stock still trades at a premium valuation, which assumes a high level of future growth. Any further deceleration could lead to more downside.</li>
                        <li><strong>Macroeconomic Sensitivity:</strong> As a consumption-based business, Atlas revenue can be sensitive to the IT spending patterns of its customers. An economic downturn could lead to slower-than-expected consumption growth.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from MongoDB, Inc. public filings (SEC reports), press releases, and credible financial data providers as of July 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (mobileMenuEl && !mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            violet: '#A78BFA',
            sky: '#7DD3FC',
            orange: '#FDBA74',
            teal: '#5EEAD4'
        };

        // Revenue Breakdown Chart
        const revenueBreakdownCtx = document.getElementById('revenueBreakdownChart').getContext('2d');
        new Chart(revenueBreakdownCtx, {
            type: 'doughnut',
            data: {
                labels: ['MongoDB Atlas', 'Enterprise Advanced'],
                datasets: [{
                    data: [69, 31], // Approximate percentages for Q1 FY26
                    backgroundColor: [CHART_COLORS.violet, CHART_COLORS.sky],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Revenue by Source (Q1 FY26)' } }
            }
        });

        // --- FINANCIAL CHARTS LOGIC ---

        // Fiscal Year ends January 31
        const yearlyDataStore = {
            labels: ['FY23', 'FY24', 'FY25'],
            totalRevenue: {
                datasets: [ { label: 'Total Revenue ($B)', data: [1.28, 1.68, 1.95], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet } ],
                yAxisLabel: 'Billions of USD'
            },
            operatingIncome: {
                datasets: [ { label: 'Non-GAAP Operating Income ($M)', data: [56, 177, 269], backgroundColor: CHART_COLORS.sky + 'BF', borderColor: CHART_COLORS.sky } ],
                yAxisLabel: 'Millions of USD'
            }
        };

        // Quarters are fiscal quarters
        const quarterlyDataStore = {
            labels: ['Q2 24', 'Q3 24', 'Q4 24', 'Q1 25', 'Q2 25', 'Q3 25', 'Q4 25', 'Q1 26'],
            totalRevenue: {
                datasets: [ { label: 'Total Revenue ($M)', data: [424, 433, 458, 451, 479, 499, 520, 486], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet } ],
                yAxisLabel: 'Millions of USD'
            },
            operatingIncome: {
                datasets: [ { label: 'Non-GAAP Operating Income ($M)', data: [70, 54, 85, 51, 69, 75, 74, 35], backgroundColor: CHART_COLORS.teal + 'BF', borderColor: CHART_COLORS.teal } ],
                yAxisLabel: 'Millions of USD'
            }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            
            const datasets = metricDetails.datasets.map(ds => {
                 // Color bars red for negative values
                return {
                    ...ds,
                    backgroundColor: ds.data.map(value => value >= 0 ? ds.backgroundColor : CHART_COLORS.orange + 'BF'),
                    borderColor: ds.data.map(value => value >= 0 ? ds.borderColor : CHART_COLORS.orange),
                };
            });
            
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                           display: false
                        }
                    },
                    scales: {
                        x: {},
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: metricDetails.yAxisLabel
                            },
                        }
                    }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'totalRevenue');
        quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'totalRevenue');

    </script>
</body>
</html>

