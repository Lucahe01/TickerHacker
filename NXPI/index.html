<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NXP Semiconductors (NXPI) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #A78BFA; /* violet-400 */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #7DD3FC; /* sky-400 */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #F97316; /* orange-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
            border-color: #8B5CF6; /* violet-500 */
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-500 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #A78BFA;">NXP Semiconductors (NXPI)</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">End Markets</a>
                        <a href="#financials" class="nav-link">Financials</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-violet-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">End Markets</a>
                    <a href="#financials" class="nav-link block text-base">Financials</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">NXP: The Automotive Semiconductor Leader</h2>
            <p class="content-text mb-6">NXP Semiconductors is a global leader in secure connectivity solutions for embedded applications, with a dominant and strategic focus on the <span class="highlight">Automotive</span> market. The company provides the essential microcontrollers, sensors, and processors that are enabling the automotive industry's transition to electric, autonomous, and connected vehicles. Beyond its automotive stronghold, NXP leverages its expertise in security and connectivity to serve the Industrial & IoT, Mobile, and Communications Infrastructure markets. The company's strategy is to win in high-growth, long-lifecycle markets where its technology provides a clear and defensible advantage.</p>
            
            <div class="grid md:grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Strategy: Winning in the Car</h3>
                    <p class="content-text mb-4">NXP's strategy is centered on its leadership in the most demanding end markets:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">Automotive First:</strong> Capitalize on the secular trends of vehicle electrification, ADAS, and in-vehicle infotainment to increase semiconductor content per vehicle.</li>
                        <li><strong class="font-semibold text-gray-700">System-Level Solutions:</strong> Provide comprehensive solutions that combine processing, connectivity, and security, simplifying the design process for customers.</li>
                        <li><strong class="font-semibold text-gray-700">Leadership in Security:</strong> Leverage its long history in secure transactions to provide trusted solutions for car access, mobile payments, and IoT security.</li>
                        <li><strong class="font-semibold text-gray-700">Disciplined Capital Allocation:</strong> Focus on profitable growth while returning significant capital to shareholders through dividends and buybacks.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-violet-50 border-violet-200">
                    <p class="kpi-label">Automotive Revenue as % of Total (2024)</p>
                    <p class="kpi-value text-violet-600">~58%</p>
                    <p class="content-text text-sm mt-2">The automotive segment is the primary engine of NXP's revenue and growth, providing a stable base of long-lifecycle design wins.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How NXP Makes Money: Four Key End Markets</h2>
            <p class="content-text mb-6">NXP's revenue is diversified across four primary end markets, with Automotive being by far the largest and most strategic.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="auto">Automotive</button>
                    <button class="segment-tab-button" data-target="ind">Industrial & IoT</button>
                    <button class="segment-tab-button" data-target="mob">Mobile</button>
                    <button class="segment-tab-button" data-target="comm">Comm. Infra.</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="autoContent" class="segment-content">
                    <h3 class="subsection-title">Automotive</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">The cornerstone of NXP's business. The company is a leading supplier of radar systems, vehicle networking, secure car access (key fobs and digital keys), and processors for infotainment and driver assistance systems (ADAS).</p>
                        </div>
                        <div class="kpi-card bg-sky-50 border-sky-200">
                            <p class="kpi-label">Automotive Revenue (2024)</p>
                            <p class="kpi-value text-sky-600">$7.5 Billion</p>
                            <p class="content-text text-sm mt-2">Driven by the secular increase in semiconductor content per vehicle.</p>
                        </div>
                    </div>
                </div>
                <div id="indContent" class="segment-content hidden">
                    <h3 class="subsection-title">Industrial & IoT</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">A broad market including factory automation, smart home devices, and connected healthcare. NXP provides microcontrollers and connectivity solutions for these applications. This segment is currently navigating a cyclical inventory correction.</p>
                        </div>
                         <div class="kpi-card bg-teal-50 border-teal-200">
                             <p class="kpi-label">Industrial & IoT Revenue (2024)</p>
                             <p class="kpi-value text-teal-600">$2.3 Billion</p>
                             <p class="content-text text-sm mt-2">A diverse market with long-term growth potential in automation and connectivity.</p>
                         </div>
                    </div>
                </div>
                 <div id="mobContent" class="segment-content hidden">
                    <h3 class="subsection-title">Mobile</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">NXP is a leader in secure mobile transactions. It provides the Near Field Communication (NFC) chips and Secure Elements that enable services like Apple Pay and Google Pay in smartphones and wearables.</p>
                        </div>
                         <div class="kpi-card bg-orange-50 border-orange-200">
                             <p class="kpi-label">Mobile Revenue (2024)</p>
                             <p class="kpi-value text-orange-600">$1.4 Billion</p>
                             <p class="content-text text-sm mt-2">A profitable niche where NXP's security expertise provides a strong advantage.</p>
                         </div>
                    </div>
                </div>
                 <div id="commContent" class="segment-content hidden">
                    <h3 class="subsection-title">Communication Infrastructure & Other</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">This segment provides RF power amplifiers for 5G base stations and other communication network equipment. It is the smallest and most volatile of NXP's end markets.</p>
                        </div>
                         <div class="kpi-card bg-red-50 border-red-200">
                             <p class="kpi-label">Comm. Infra. Revenue (2024)</p>
                             <p class="kpi-value text-red-600">$1.8 Billion</p>
                             <p class="content-text text-sm mt-2">Tied to the capital expenditure cycles of large telecommunication companies.</p>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive</h2>
            <p class="content-text mb-6">NXP's financial results demonstrate the strength and scale of its automotive business, which has provided resilience while other semiconductor markets experience cyclical downturns. The company is highly profitable and generates significant free cash flow.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (FY22-FY24)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                            <option value="revenue" selected>Revenue by End Market ($B)</option>
                            <option value="opIncome">Non-GAAP Operating Income ($B)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Trends (Recent 8 Qtrs)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Quarterly Metric:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                             <option value="revenue" selected>Revenue by End Market ($B)</option>
                             <option value="opIncome">Non-GAAP Operating Income ($M)</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">The financial charts highlight the growing dominance of the Automotive segment and the cyclicality in the Industrial & IoT market.</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: The Automotive Fortress</h2>
            <p class="content-text mb-6">NXP's competitive moat is one of the strongest in the semiconductor industry, built on its entrenched leadership in the demanding automotive market.</p>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">High Switching Costs:</strong> Automotive design cycles are very long (5+ years), and semiconductor suppliers are deeply integrated into the design and safety processes of carmakers. It is extremely difficult and costly for an automaker to switch suppliers mid-cycle.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Market Leadership & Scale:</strong> NXP is the #1 or #2 global supplier in most of its target automotive product categories, giving it scale advantages and deep relationships with all major car manufacturers.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">➔</span>
                            <span class="content-text"><strong class="text-gray-700">Security Expertise:</strong> The company's deep knowledge of secure transaction and connectivity technologies provides a critical advantage in applications like secure car access and in-vehicle networking.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Infineon Technologies:</strong> A major competitor, particularly in automotive microcontrollers and power semiconductors.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Renesas Electronics:</strong> A key Japanese competitor with a strong focus on the automotive market.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">●</span>
                            <span class="content-text"><strong class="text-gray-700">Texas Instruments & STMicroelectronics:</strong> Large, diversified semiconductor companies that compete with NXP across its various end markets.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: Risks & Rewards</h2>
            <p class="content-text mb-6">NXP is a premier industrial and automotive semiconductor company, offering a compelling combination of defensive characteristics and exposure to powerful long-term growth trends.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities 🚀</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Content per Vehicle Growth:</strong> The shift to EVs and more advanced autonomous features is driving a massive increase in semiconductor content per car, providing a powerful secular tailwind.</li>
                        <li><strong>Industrial & IoT Recovery:</strong> A cyclical recovery in the industrial and consumer-related IoT markets would provide an additional boost to growth.</li>
                        <li><strong>Strong Profitability & Cash Flow:</strong> The company's high-margin business model generates significant free cash flow, which is consistently returned to shareholders.</li>
                        <li><strong>Defensive Characteristics:** The long design cycles and high switching costs in the automotive business provide a greater degree of stability and visibility than many other semiconductor companies.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-orange-600">Risks & Challenges 📉</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Automotive Market Cyclicality:</strong> While NXP is benefiting from content growth, a sharp downturn in global car production would still be a significant headwind.</li>
                        <li><strong>Broader Semiconductor Cycle:</strong> The company is not immune to the inventory corrections and demand fluctuations that affect the entire semiconductor industry.</li>
                        <li><strong>Competition:** The market for automotive and industrial semiconductors is highly competitive, with large, well-funded rivals all competing for the same design wins.</li>
                        <li><strong>Geopolitical Risk:** As a global company with a complex supply chain and significant exposure to China, NXP faces risks from trade tensions and potential disruptions.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from NXP Semiconductors N.V. public filings and credible financial data providers as of July 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (mobileMenuEl && !mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = "'Inter', sans-serif";
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            violet: '#A78BFA',
            sky: '#7DD3FC',
            orange: '#FDBA74',
            teal: '#5EEAD4',
            red: '#F87171'
        };
        
        // --- FINANCIAL CHARTS LOGIC ---

        const yearlyDataStore = {
            labels: ['FY22', 'FY23', 'FY24'],
            revenue: {
                datasets: [
                    { label: 'Automotive ($B)', data: [6.9, 7.5, 7.5], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet, stack: 'Stack 0' },
                    { label: 'Industrial & IoT ($B)', data: [2.8, 2.6, 2.3], backgroundColor: CHART_COLORS.sky + 'BF', borderColor: CHART_COLORS.sky, stack: 'Stack 0' },
                    { label: 'Mobile ($B)', data: [1.7, 1.5, 1.4], backgroundColor: CHART_COLORS.orange + 'BF', borderColor: CHART_COLORS.orange, stack: 'Stack 0' },
                    { label: 'Comm. Infra. & Other ($B)', data: [2.1, 1.9, 1.8], backgroundColor: CHART_COLORS.teal + 'BF', borderColor: CHART_COLORS.teal, stack: 'Stack 0' }
                ],
                yAxisLabel: 'Billions of USD'
            },
            opIncome: {
                datasets: [ { label: 'Non-GAAP Operating Income ($B)', data: [4.7, 4.4, 4.2], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet } ],
                yAxisLabel: 'Billions of USD'
            }
        };

        const quarterlyDataStore = {
            labels: ['Q2 23', 'Q3 23', 'Q4 23', 'Q1 24', 'Q2 24', 'Q3 24', 'Q4 24', 'Q1 25'],
            revenue: {
                datasets: [
                    { label: 'Automotive ($M)', data: [1866, 1891, 1899, 1805, 1850, 1870, 1900, 1920], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet, stack: 'Stack 0' },
                    { label: 'Industrial & IoT ($M)', data: [658, 591, 565, 538, 550, 570, 600, 610], backgroundColor: CHART_COLORS.sky + 'BF', borderColor: CHART_COLORS.sky, stack: 'Stack 0' },
                    { label: 'Mobile ($M)', data: [377, 349, 340, 331, 345, 360, 370, 380], backgroundColor: CHART_COLORS.orange + 'BF', borderColor: CHART_COLORS.orange, stack: 'Stack 0' },
                    { label: 'Comm. Infra. & Other ($M)', data: [420, 436, 473, 498, 480, 460, 450, 440], backgroundColor: CHART_COLORS.teal + 'BF', borderColor: CHART_COLORS.teal, stack: 'Stack 0' },
                ],
                yAxisLabel: 'Millions of USD'
            },
            opIncome: {
                datasets: [ { label: 'Non-GAAP Operating Income ($M)', data: [1119, 1099, 1149, 1045, 1080, 1050, 1030, 1060], backgroundColor: CHART_COLORS.violet + 'BF', borderColor: CHART_COLORS.violet } ],
                yAxisLabel: 'Millions of USD'
            }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            const isStacked = metricKey === 'revenue';
            
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: metricDetails.datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed.y !== null) {
                                        let val = context.parsed.y;
                                        let unit = label.includes('($B)') ? 'B' : 'M';
                                        label += '$' + val.toFixed(2) + unit;
                                    }
                                    return label;
                                }
                            }
                        },
                        legend: {
                            position: 'bottom',
                            display: isStacked
                        }
                    },
                    scales: {
                        x: {
                            stacked: isStacked,
                        },
                        y: {
                            stacked: isStacked,
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: metricDetails.yAxisLabel
                            },
                            ticks: {
                                callback: function(value) {
                                     let unit = metricDetails.yAxisLabel.includes('Billions') ? 'B' : 'M';
                                     return '$' + value / (unit === 'B' ? 1 : 1000) + unit;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'revenue');
        quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'revenue');

    </script>
</body>
</html>

