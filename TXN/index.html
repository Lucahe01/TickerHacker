<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Texas Instruments (TXN) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #A78BFA; /* violet-400 */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #7DD3FC; /* sky-400 */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #F97316; /* orange-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
            border-color: #8B5CF6; /* violet-500 */
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #A78BFA; /* violet-400 */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-500 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #A78BFA;">Texas Instruments (TXN) Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">Business Segments</a>
                        <a href="#financials" class="nav-link">Financials</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-violet-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">Business Segments</a>
                    <a href="#financials" class="nav-link block text-base">Financials</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">Texas Instruments: The Bedrock of the Electronics Industry</h2>
            <p class="content-text mb-6">Texas Instruments Incorporated (TXN) is a global semiconductor powerhouse and the world's largest producer of analog and embedded processing chips. These components are fundamental building blocks in virtually every type of electronic equipment. Rather than focusing on the high-profile digital chips that power computers and smartphones, TXN thrives by manufacturing the essential, long-lasting chips that handle tasks like power management, data conversion, and signal processing. The company's core strategy is built on a massive competitive advantage: <span class="highlight">in-house manufacturing on 300-millimeter wafers</span>. This provides a significant cost advantage, greater control over its supply chain, and a durable moat that is difficult for competitors to replicate. TXN is strategically focused on the industrial and automotive markets, which value long product lifecycles and supply chain reliability.</p>
            
            <div class="grid md:grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Strategy: Manufacturing & Market Focus</h3>
                    <p class="content-text mb-4">TXN's strategy is clear, consistent, and centered on long-term value creation:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">300mm Wafer Production:</strong> Aggressively investing in and transitioning manufacturing to 300mm wafers, which provides a 40% cost advantage per chip compared to the 200mm wafers used by most competitors.</li>
                        <li><strong class="font-semibold text-gray-700">Industrial & Automotive Dominance:</strong> Focusing R&D and sales efforts on the industrial and automotive sectors, which represent over 75% of revenue and offer stable, long-term growth.</li>
                        <li><strong class="font-semibold text-gray-700">Broad Portfolio & Direct Sales:</strong> Offering a diverse catalog of over 80,000 products and increasingly selling directly to customers through TI.com, which improves margins and builds stronger relationships.</li>
                        <li><strong class="font-semibold text-gray-700">Disciplined Capital Allocation:</strong> A commitment to returning all free cash flow to shareholders through a combination of a sustainable, growing dividend and share repurchases.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-violet-50 border-violet-200">
                    <p class="kpi-label">Target In-House Manufacturing</p>
                    <p class="kpi-value text-violet-600">>90%</p>
                    <p class="content-text text-sm mt-2">By 2030, TXN aims to have over 90% of its manufacturing in-house, with the majority on cost-advantaged 300mm wafers, ensuring supply chain control and superior margins.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How Texas Instruments Makes Money: Two Pillars of Growth</h2>
            <p class="content-text mb-6">Texas Instruments' business is organized into two primary segments that provide the foundational technology for the electronics industry. The company's revenue is highly diversified across tens of thousands of products and customers, making it a resilient bellwether for the semiconductor market. The focus is on creating essential components for high-growth, long-lifecycle applications.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="analog">Analog</button>
                    <button class="segment-tab-button" data-target="embedded">Embedded Processing</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="analogContent" class="segment-content">
                    <h3 class="subsection-title">Analog (~77% of FY2023 Revenue)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">This is the core of TXN's business. Analog chips manage power and translate real-world signals (like sound, pressure, and temperature) into digital data that can be processed. They are essential in every electronic device.</p>
                             <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Products:</strong> Power management ICs, signal chain components like amplifiers and data converters.</li>
                                <li><strong>Applications:</strong> Battery charging and power supplies in EVs, factory robotics, medical sensors, and countless other systems.</li>
                                <li><strong>Market Position:</strong> TXN is the undisputed global leader in analog semiconductors, with a market share of around 20%.</li>
                             </ul>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="revenueBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>
                <div id="embeddedContent" class="segment-content hidden">
                    <h3 class="subsection-title">Embedded Processing (~16% of FY2023 Revenue)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">Embedded processors are the "brains" of electronic systems, designed to handle specific tasks. They are microcontrollers and processors that are embedded within devices to provide computing power and control.</p>
                            <ul class="list-disc list-inside content-text space-y-1 pl-4 mt-4">
                                <li><strong>Key Products:</strong> Microcontrollers (MCUs) and digital signal processors (DSPs).</li>
                                <li><strong>Applications:</strong> Controlling motors in electric vehicles, managing displays in car dashboards, processing data in smart thermostats, and enabling advanced driver-assistance systems (ADAS).</li>
                            </ul>
                        </div>
                        <div class="kpi-card bg-sky-50 border-sky-200">
                             <p class="kpi-label">Focus Markets</p>
                             <p class="kpi-value text-sky-600">Industrial & Automotive</p>
                             <p class="content-text text-sm mt-2">These two markets represented a combined 76% of revenue in 2023, up from just 42% a decade ago, reflecting a deliberate and successful strategic shift.</p>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive</h2>
            <p class="content-text mb-6">Texas Instruments has a long history of strong profitability and exceptional free cash flow generation, a direct result of its manufacturing cost advantages and disciplined operational focus. The company is currently navigating a cyclical downturn in the semiconductor market, characterized by customer inventory destocking, but remains highly profitable with a robust balance sheet to fund its long-term strategic investments.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (2021-2024)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                            <option value="totalRevenue" selected>Total Revenue ($B)</option>
                            <option value="operatingIncome">Operating Income ($B)</option>
                            <option value="operatingCashFlow">Operating Cash Flow ($B)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Trends (Recent 8 Qtrs)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Quarterly Metric:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-violet-500 focus:border-violet-500">
                             <option value="totalRevenue" selected>Total Revenue ($B)</option>
                             <option value="nonGaapEps">EPS ($)</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">Financial trends reflect the peak of the semiconductor cycle in 2022 followed by a correction in 2023-2024. The focus is on long-term cash flow generation through these cycles.</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: The Unmatched Manufacturer</h2>
            <p class="content-text mb-6">Texas Instruments' competitive moat is one of the widest in the semiconductor industry. It is not based on a single technology but on a deeply entrenched, multi-faceted strategy that combines cost leadership, scale, and customer access.</p>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">Manufacturing Cost Advantage:</strong> The aggressive shift to in-house 300mm wafer production provides a structural cost advantage of ~40% per chip over competitors, enabling industry-leading gross margins and R&D investment capacity.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">Broad & Diverse Portfolio:</strong> With over 80,000 products, TXN is a one-stop-shop for a customer's analog and embedded needs. This scale creates sticky relationships and makes them an indispensable supplier.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">Direct Distribution Channel:</strong> The move to sell directly via TI.com cuts out distributor markups, improving margins and giving TXN direct access to customer data and design trends.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-violet-500 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">High Switching Costs:</strong> Like other analog chipmakers, TXN benefits as its inexpensive but critical components are designed into long-lifecycle products (like cars and industrial machinery), making it costly and risky for customers to switch suppliers.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">‚óè</span>
                            <span class="content-text"><strong class="text-gray-700">Analog Devices (ADI):</strong> The strongest competitor, also focusing on high-performance analog chips for industrial and automotive markets.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">‚óè</span>
                            <span class="content-text"><strong class="text-gray-700">STMicroelectronics (STM) & Infineon (IFX):</strong> European powerhouses with a strong presence in automotive and power management semiconductors.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-sky-500 mr-2 mt-1">‚óè</span>
                            <span class="content-text"><strong class="text-gray-700">NXP Semiconductors (NXPI):</strong> A key competitor in the automotive and secure connectivity microcontroller space.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: Risks & Rewards</h2>
            <p class="content-text mb-6">Texas Instruments is executing a long-term strategy that sacrifices near-term financial results for a dominant competitive position in the decades to come. The primary risk is the high capital intensity of this strategy, while the reward is a wider moat and superior profitability through all market cycles.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities üöÄ</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Long-Term Secular Growth:</strong> Perfectly positioned to benefit from the increasing semiconductor content in cars and industrial equipment.</li>
                        <li><strong>Widening Cost Moat:</strong> Heavy investment in 300mm fabs today is expected to cement a multi-decade cost advantage and drive superior free cash flow per share in the future.</li>
                        <li><strong>Reliable Capital Returns:</strong> A long, uninterrupted history of returning cash to shareholders via dividends and buybacks provides a strong underpin for total shareholder return.</li>
                        <li><strong>Supply Chain Control:</strong> In-house manufacturing provides greater reliability and control over supply, a key selling point for automotive and industrial customers.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-orange-600">Risks & Challenges üìâ</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Semiconductor Cyclicality:</strong> The business is inherently cyclical. The current downturn is impacting revenue and margins, and the timing of a recovery is uncertain.</li>
                        <li><strong>High Capital Intensity:</strong> The strategy to build numerous new fabs requires massive capital expenditures ($5B annually), which will suppress free cash flow in the near term (through ~2026).</li>
                        <li><strong>Execution Risk:</strong> There is significant risk in executing a capex plan of this magnitude. Any delays or cost overruns could impact future returns.</li>
                        <li><strong>Geopolitical Risk:</strong> As a global leader with manufacturing and sales worldwide, TXN is exposed to ongoing trade tensions, particularly with China.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from Texas Instruments Inc. public filings (SEC 10-K & 10-Q reports) and credible financial data providers as of June 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (mobileMenuEl && !mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = 'Inter, sans-serif';
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            violet: '#A78BFA',
            sky: '#7DD3FC',
            orange: '#FDBA74',
            stone: '#E7E5E4',
            gray: '#4B5563',
            darkViolet: '#8B5CF6',
            darkSky: '#38BDF8',
            teal: '#5EEAD4'
        };

        // Revenue Breakdown Chart
        const revenueBreakdownCtx = document.getElementById('revenueBreakdownChart').getContext('2d');
        new Chart(revenueBreakdownCtx, {
            type: 'doughnut',
            data: {
                labels: ['Analog', 'Embedded Processing', 'Other'],
                datasets: [{
                    data: [77, 16, 7], // Approximate FY2023 percentages
                    backgroundColor: [CHART_COLORS.violet, CHART_COLORS.sky, CHART_COLORS.teal],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Revenue by Segment (FY2023)' } }
            }
        });

        // --- FINANCIAL CHARTS LOGIC ---

        // Yearly Data Store (Fiscal Years end Dec 31)
        const yearlyDataStore = {
            labels: ['FY21', 'FY22', 'FY23', 'FY24'],
            totalRevenue: { data: [18.34, 20.03, 17.52, 14.16], label: 'Total Revenue ($B)', color: CHART_COLORS.violet },
            operatingIncome: { data: [8.93, 10.12, 7.57, 4.39], label: 'Operating Income ($B)', color: CHART_COLORS.sky },
            operatingCashFlow: { data: [7.71, 8.41, 6.45, 1.37], label: 'Operating Cash Flow ($B)', color: CHART_COLORS.orange }
        };

        // Quarterly Data Store
        const quarterlyDataStore = {
            labels: ['Q3 23', 'Q4 23', 'Q1 24', 'Q2 24', 'Q3 24', 'Q4 24', 'Q1 25', 'Q2 25'],
            totalRevenue: { data: [4.53, 3.93, 3.66, 3.42, 3.48, 3.60, 3.29, 3.25], label: 'Total Revenue ($B)', color: CHART_COLORS.violet },
            nonGaapEps: { data: [1.99, 1.49, 1.20, 1.07, 1.09, 1.12, 0.99, 0.95], label: 'EPS ($)', color: CHART_COLORS.teal }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            const isLineChart = metricKey === 'nonGaapEps';

            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: [{
                        label: metricDetails.label,
                        data: metricDetails.data,
                        backgroundColor: isLineChart ? 'transparent' : metricDetails.color + 'BF',
                        borderColor: metricDetails.color,
                        borderWidth: 2,
                        type: isLineChart ? 'line' : 'bar',
                        fill: !isLineChart,
                        tension: 0.1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { 
                        y: { 
                            beginAtZero: true, 
                            title: { display: true, text: metricDetails.label.split('(')[1].replace(')','') }
                        } 
                    },
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'totalRevenue');
        quarterlyChart = createChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'totalRevenue');

    </script>
</body>
</html>

