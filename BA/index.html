<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Boeing Company (BA) - TickerHack Deep Research</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F5F5F4; /* stone-100 */
            color: #374151; /* gray-700 */
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 350px;
        }
        @media (min-width: 768px) { /* md */
            .chart-container {
                height: 350px;
                max-height: 400px;
            }
        }
        .section-card {
            background-color: #FFFFFF;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.07), 0 4px 6px -2px rgba(0, 0, 0, 0.04); /* Softer shadow */
            padding: 1.5rem; /* p-6 */
            margin-bottom: 2rem; /* mb-8 */
        }
        .main-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1F2937; /* gray-800 */
            margin-bottom: 1rem;
            text-align: center;
        }
        .section-title {
            font-size: 1.875rem; /* text-3xl */
            font-weight: 600; /* font-semibold */
            color: #0039A6; /* Boeing Blue */
            margin-bottom: 1.5rem; /* mb-6 */
            padding-bottom: 0.5rem; /* pb-2 */
            border-bottom: 2px solid #E7E5E4; /* stone-200 */
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #3B82F6; /* Lighter Blue */
            margin-top: 1.5rem; /* mt-6 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .content-text {
            line-height: 1.75;
            color: #4B5563; /* gray-600 */
            font-size: 0.95rem;
        }
        .highlight {
            color: #EF4444; /* red-500 */
            font-weight: 600;
        }
        .tab-button {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            font-size: 0.875rem; /* text-sm */
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s;
            background-color: #E7E5E4; /* stone-200 */
            color: #374151; /* gray-700 */
            border: 1px solid transparent;
        }
        .tab-button.active {
            background-color: #0039A6; /* Boeing Blue */
            color: #FFFFFF;
            border-color: #002D84; 
        }
        .nav-link {
            padding: 0.5rem 1rem;
            border-radius: 0.375rem; /* rounded-md */
            font-weight: 500;
            color: #374151; /* gray-700 */
            transition: background-color 0.2s ease-in-out, color 0.2s ease-in-out;
            white-space: nowrap;
        }
        .nav-link:hover, .nav-link.active {
            background-color: #0039A6; /* Boeing Blue */
            color: #FFFFFF;
        }
        .kpi-card {
            background-color: #F9FAFB; /* gray-50 */
            border: 1px solid #E7E5E4; /* stone-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            text-align: center;
        }
        .kpi-label {
            font-size: 0.875rem; /* text-sm */
            color: #6B7280; /* gray-600 */
            margin-bottom: 0.25rem;
        }
        .kpi-value {
            font-size: 1.75rem; /* text-2xl or 3xl */
            font-weight: 600;
            color: #1F2937; /* gray-800 */
        }
    </style>
</head>
<body class="min-h-screen">

    <header class="sticky top-0 z-50 bg-white/95 backdrop-blur-md shadow-md">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold" style="color: #0039A6;">The Boeing Company (BA) Analysis</h1>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-1 lg:space-x-2">
                        <a href="#overview" class="nav-link">Overview</a>
                        <a href="#segments" class="nav-link">Business Segments</a>
                        <a href="#financials" class="nav-link">Financials</a>
                        <a href="#competition" class="nav-link">Competitive Moat</a>
                        <a href="#outlook" class="nav-link">Outlook</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button id="mobile-menu-button" type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-gray-700 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" /></svg>
                        <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" /></svg>
                    </button>
                </div>
            </div>
            <div class="md:hidden hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#overview" class="nav-link block text-base">Overview</a>
                    <a href="#segments" class="nav-link block text-base">Business Segments</a>
                    <a href="#financials" class="nav-link block text-base">Financials</a>
                    <a href="#competition" class="nav-link block text-base">Competitive Moat</a>
                    <a href="#outlook" class="nav-link block text-base">Outlook</a>
                </div>
            </div>
        </nav>
    </header>

    <main class="container mx-auto p-4 md:p-6 lg:p-8 mt-4">

        <section id="overview" class="section-card scroll-mt-20">
            <h2 class="section-title">Boeing: An Aerospace Giant Navigating a Crisis</h2>
            <p class="content-text mb-6">The Boeing Company is one of the world's largest aerospace manufacturers and defense contractors, with a storied history of innovation. However, the company is currently navigating a profound crisis of confidence centered on its manufacturing quality and safety culture. Following a series of high-profile incidents, most notably the January 2025 Alaska Airlines 737 MAX door plug blowout, Boeing is under intense scrutiny from regulators, airlines, and the public. The company's current strategy is entirely focused on a turnaround: stabilizing its production systems, improving quality control, and rebuilding trust. This analysis explores Boeing's three core business segments and the immense challenges and long-term potential of this American industrial icon.</p>
            
            <div class="grid md:grid-cols-2 gap-6 items-start">
                <div>
                    <h3 class="subsection-title !mt-0">Core Turnaround Strategy</h3>
                    <p class="content-text mb-4">Boeing's immediate priorities are foundational:</p>
                    <ul class="list-disc list-inside content-text space-y-1 pl-4">
                        <li><strong class="font-semibold text-gray-700">Prioritize Safety & Quality Above All Else:</strong> Implement sweeping changes to manufacturing processes, quality inspections, and engineering oversight to address systemic issues and satisfy the stringent requirements of the FAA.</li>
                        <li><strong class="font-semibold text-gray-700">Stabilize the Production System:</strong> Deliberately slow production rates, particularly for the 737 MAX, to reduce "traveled work" and ensure each plane is built to specification before moving down the line.</li>
                        <li><strong class="font-semibold text-gray-700">Strengthen the Supply Chain:</strong> Work closely with suppliers to manage bottlenecks and improve the quality and consistency of parts flowing into its factories.</li>
                        <li><strong class="font-semibold text-gray-700">Improve Financial Health:</strong> Manage liquidity and use any available cash flow to reduce its substantial debt load, which has grown significantly through years of operational challenges.</li>
                    </ul>
                </div>
                <div class="kpi-card bg-blue-50 border-blue-200">
                    <p class="kpi-label">Total Company Backlog</p>
                    <p class="kpi-value text-blue-800">$510+ Billion</p>
                    <p class="content-text text-sm mt-2">Includes over 5,600 commercial airplanes, representing a massive, multi-year pipeline of future revenue if the company can fix its production issues.</p>
                </div>
            </div>
        </section>

        <section id="segments" class="section-card scroll-mt-20">
            <h2 class="section-title">How Boeing Makes Money: The Three Segments</h2>
            <p class="content-text mb-6">Boeing's business operates through three major segments. The **Commercial Airplanes (BCA)** division is its most well-known, but is currently its most troubled. The **Defense, Space & Security (BDS)** segment provides a more stable foundation of government contracts. The **Global Services (BGS)** division is a high-margin, recurring revenue business that supports the massive fleet of Boeing aircraft worldwide.</p>

            <div class="mb-6 border-b border-stone-200">
                <nav class="-mb-px flex space-x-4" aria-label="Tabs">
                    <button class="segment-tab-button active" data-target="bca">Commercial Airplanes (BCA)</button>
                    <button class="segment-tab-button" data-target="bds">Defense, Space & Security</button>
                    <button class="segment-tab-button" data-target="bgs">Global Services</button>
                </nav>
            </div>

            <div id="segmentDetails">
                <div id="bcaContent" class="segment-content">
                    <h3 class="subsection-title">Commercial Airplanes (BCA)</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="content-text mb-2">This segment designs, manufactures, and sells commercial jetliners to airlines around the world. It includes the 737 family (the workhorse for short-haul travel) and widebody jets like the 787 Dreamliner and 777. For years, this segment was a massive profit engine, but it is now incurring significant losses due to <span class="highlight">production slowdowns, customer compensation, and operational inefficiencies</span> as it works to fix its quality issues. Its performance is measured by the number of aircraft delivered each quarter.</p>
                        </div>
                        <div class="chart-container h-72 md:h-80">
                            <canvas id="segmentBreakdownChart"></canvas>
                        </div>
                    </div>
                </div>
                <div id="bdsContent" class="segment-content hidden">
                    <h3 class="subsection-title">Defense, Space & Security (BDS)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">The BDS segment provides a crucial source of stability for the company. It researches, develops, produces, and modifies military aircraft, satellites, and other defense systems. Key products include fighter jets like the F-15 and F/A-18, the P-8 maritime patrol aircraft, and various satellite and autonomous systems. Customers are primarily the U.S. Department of Defense and allied governments, which provides a base of long-term, predictable revenue.</p>
                        </div>
                        <div class="kpi-card bg-blue-50 border-blue-200 p-6 flex flex-col justify-center">
                            <p class="kpi-label">Key Customer</p>
                            <p class="kpi-value text-blue-800 text-2xl">U.S. Government</p>
                            <p class="content-text text-sm mt-2">The U.S. Department of Defense is the largest customer for this segment, providing a stable foundation of contracts for critical national security programs.</p>
                        </div>
                    </div>
                </div>
                <div id="bgsContent" class="segment-content hidden">
                    <h3 class="subsection-title">Global Services (BGS)</h3>
                     <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div>
                            <p class="content-text mb-2">This is Boeing's most profitable and highest-margin segment. BGS provides a vast array of aftermarket services for the thousands of Boeing commercial and defense aircraft in operation globally. This includes providing spare parts, maintenance, engineering support, and digital analytics solutions. As a recurring revenue business built on the massive installed base of aircraft, BGS is a critical source of cash flow that helps support the rest of the company.</p>
                        </div>
                        <div class="kpi-card bg-blue-50 border-blue-200 p-6 flex flex-col justify-center">
                            <p class="kpi-label">BGS Operating Margin (FY2024)</p>
                            <p class="kpi-value text-blue-800">17.5%</p>
                            <p class="content-text text-sm mt-2">Highlights the high profitability of the services business, which is a crucial financial cushion for the company during its current challenges.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="financials" class="section-card scroll-mt-20">
            <h2 class="section-title">Financial Deep Dive</h2>
            <p class="content-text mb-6">Boeing's financial results reflect a company in deep distress. Years of production issues, supply chain disruptions, and the ongoing safety crisis have resulted in significant operating losses and negative cash flow. The key focus for investors is not past performance, but forward-looking indicators of a turnaround: stabilizing and then increasing aircraft delivery rates, improving cash flow, and reducing its substantial debt load. The charts below illustrate the ongoing financial challenges.</p>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title">Fiscal Year Trends (2020-2024)</h3>
                    <div class="mb-4">
                        <label for="yearlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">Select Annual Metric:</label>
                        <select id="yearlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="netRevenue" selected>Total Revenue ($B)</option>
                            <option value="operatingLoss">Operating Loss ($B)</option>
                        </select>
                    </div>
                    <div id="yearlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="yearlyFinancialChart"></canvas>
                    </div>
                </div>

                <div>
                    <h3 class="subsection-title">Quarterly Segment Revenue ($B)</h3>
                     <div class="mb-4">
                        <label for="quarterlyMetricSelect" class="block text-sm font-medium text-gray-700 mb-1">View:</label>
                        <select id="quarterlyMetricSelect" class="block w-full p-2 border border-stone-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                            <option value="segmentRevenue" selected>Revenue by Segment</option>
                        </select>
                    </div>
                    <div id="quarterlyFinancialChartContainer" class="chart-container h-80 max-w-full">
                        <canvas id="quarterlyFinancialChart"></canvas>
                    </div>
                </div>
            </div>
             <p class="content-text text-sm mt-6 text-center">The financial charts highlight years of struggle, with large operating losses driven by the Commercial Airplanes division. The services and defense segments provide a partial, but insufficient, offset.</p>
        </section>

        <section id="competition" class="section-card scroll-mt-20">
            <h2 class="section-title">Competitive Moat: The Global Duopoly</h2>
            <p class="content-text mb-6">Despite its severe internal challenges, Boeing's competitive moat remains extraordinarily wide, primarily due to the structure of the industries in which it operates. The barriers to entry in designing and certifying large commercial aircraft are among the highest in any industry on Earth.</p>
            
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0">Key Moats</h3>
                    <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-blue-700 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">Duopolistic Market Structure:</strong> The market for large commercial jetliners is a duopoly with Airbus. The immense capital, decades of engineering expertise, complex global supply chains, and stringent regulatory certification required to build these aircraft make it virtually impossible for a new competitor to emerge.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-700 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">Massive Installed Base:</strong> There are thousands of Boeing aircraft in service globally. This creates a captive, multi-decade revenue stream for the high-margin Global Services (BGS) division, which provides spare parts and maintenance.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-700 mr-2 mt-1">‚ûî</span>
                            <span class="content-text"><strong class="text-gray-700">Critical Defense & National Security Role:</strong> Boeing is a cornerstone of the U.S. defense industrial base. Its role in producing critical military aircraft and space systems ensures a stable foundation of government support and contracts.</span>
                        </li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0">Primary Competitors</h3>
                     <ul class="list-none space-y-3">
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚óè</span>
                            <span class="content-text"><strong class="text-gray-700">Airbus:</strong> The primary and most direct competitor in the commercial aircraft market. Airbus is currently capitalizing on Boeing's production issues to gain significant market share.</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚óè</span>
                            <span class="content-text"><strong class="text-gray-700">Other Defense Contractors:</strong> In the defense segment, Boeing competes with other large defense primes like Lockheed Martin and Northrop Grumman for major government contracts.</span>
                        </li>
                         <li class="flex items-start">
                            <span class="text-blue-500 mr-2 mt-1">‚óè</span>
                             <span class="content-text"><strong class="text-gray-700">Emerging Competitors:</strong> While not yet a threat in the large jetliner market, China's COMAC is an emerging state-backed competitor in the narrow-body aircraft space.</span>
                        </li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="outlook" class="section-card scroll-mt-20">
            <h2 class="section-title">Strategic Outlook: A High-Stakes Turnaround</h2>
            <p class="content-text mb-6">The investment thesis for Boeing is a high-risk, high-reward bet on a successful operational turnaround. The company's powerful moat and massive backlog provide a path to recovery, but the execution risks are immense. Success requires a fundamental cultural and operational transformation to restore trust with regulators and customers.</p>
            <div class="grid md:grid-cols-2 gap-8">
                <div>
                    <h3 class="subsection-title !mt-0 text-teal-600">Rewards & Opportunities üöÄ</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Successful Turnaround & Production Ramp:</strong> If Boeing can demonstrably fix its quality issues, it can begin to ramp up production and deliveries, unlocking massive revenue and cash flow from its huge backlog.</li>
                        <li><strong>Secular Growth in Air Travel:</strong> The long-term global demand for new, more fuel-efficient aircraft remains incredibly strong, providing a powerful tailwind for both Boeing and Airbus.</li>
                        <li><strong>Durable, High-Margin Services Business:</strong> The Global Services segment provides a stable and growing source of high-margin cash flow that acts as a financial bedrock during the turnaround.</li>
                        <li><strong>Duopoly Pricing Power:</strong> Once production is stabilized, the duopolistic nature of the industry provides significant long-term pricing power.</li>
                    </ul>
                </div>
                <div>
                    <h3 class="subsection-title !mt-0 text-orange-600">Risks & Challenges üìâ</h3>
                    <ul class="list-disc list-inside content-text space-y-2 pl-4">
                        <li><strong>Safety, Quality & Execution Risk:</strong> This is the paramount risk. A failure to fundamentally fix its manufacturing and safety culture could lead to further incidents, harsh regulatory action, and irreparable damage to its brand.</li>
                        <li><strong>Loss of Market Share to Airbus:</strong> Every delay and production cut at Boeing is an opportunity for Airbus to gain customers and extend its market leadership, which could be difficult to win back.</li>
                        <li><strong>Supply Chain Constraints:</strong> The entire aerospace industry is facing bottlenecks for key components like engines and fuselages, which could hamper any future production ramp-up.</li>
                        <li><strong>Massive Debt Load:</strong> Boeing is operating with a very high debt load, which constrains its financial flexibility and makes it vulnerable to any further operational or macroeconomic setbacks.</li>
                    </ul>
                </div>
            </div>
        </section>

        <footer class="bg-stone-800 text-stone-300 py-8 text-center mt-12">
            <p class="text-sm">&copy; <span id="currentYearFooter"></span> TickerHack Deep Research. For informational purposes only.</p>
            <p class="text-xs mt-1">Data synthesized from The Boeing Company public filings and credible financial news sources as of June 2025.</p>
        </footer>

    <script>
        document.getElementById('currentYearFooter').textContent = new Date().getFullYear();

        // Mobile menu toggle
        const mobileMenuBtn = document.getElementById('mobile-menu-button');
        const mobileMenuEl = document.getElementById('mobile-menu');
        mobileMenuBtn.addEventListener('click', () => {
            mobileMenuEl.classList.toggle('hidden');
            mobileMenuBtn.querySelectorAll('svg').forEach(svg => svg.classList.toggle('hidden'));
        });
        
        // Smooth scroll and active nav link highlighting
        const navLinks = document.querySelectorAll('header nav a[href^="#"]');
        navLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                if (!mobileMenuEl.classList.contains('hidden')) {
                    mobileMenuBtn.click(); // Close mobile menu if open
                }
                navLinks.forEach(l => l.classList.remove('active'));
                e.currentTarget.classList.add('active');
            });
        });
        
        // Segment Tabs
        const segmentTabs = document.querySelectorAll('.segment-tab-button');
        const segmentContents = document.querySelectorAll('.segment-content');
        segmentTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                segmentTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                const targetId = tab.dataset.target + 'Content';
                segmentContents.forEach(content => {
                    content.id === targetId ? content.classList.remove('hidden') : content.classList.add('hidden');
                });
            });
        });

        // Chart.js Global Config
        Chart.defaults.font.family = 'Inter, sans-serif';
        Chart.defaults.color = '#4B5563';

        const CHART_COLORS = {
            blue: '#0039A6',
            sky: '#3B82F6',
            gray: '#6B7280'
        };

        // Segment Breakdown Chart (Doughnut)
        const segmentBreakdownCtx = document.getElementById('segmentBreakdownChart').getContext('2d');
        new Chart(segmentBreakdownCtx, {
            type: 'doughnut',
            data: {
                labels: ['Commercial Airplanes (BCA)', 'Defense, Space & Security (BDS)', 'Global Services (BGS)'],
                datasets: [{
                    label: 'FY2024 Revenue Mix',
                    data: [42, 32, 26], // Approximate revenue %
                    backgroundColor: [CHART_COLORS.blue, CHART_COLORS.sky, CHART_COLORS.gray],
                    hoverOffset: 4
                }]
            },
            options: {
                responsive: true, maintainAspectRatio: false,
                plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'FY2024 Revenue Mix by Segment (%)' } }
            }
        });
        
        // --- FINANCIAL CHARTS LOGIC ---

        // Yearly Data Store
        const yearlyDataStore = {
            labels: ['FY20', 'FY21', 'FY22', 'FY23', 'FY24'],
            netRevenue: { data: [58.2, 62.3, 66.6, 77.8, 81.2], label: 'Total Revenue ($B)', color: CHART_COLORS.blue },
            operatingLoss: { data: [-12.8, -4.1, -3.5, -2.1, -1.8], label: 'Operating Loss ($B)', color: CHART_COLORS.sky },
        };

        // Quarterly Data Store
        const quarterlyDataStore = {
            labels: ['Q2 23', 'Q3 23', 'Q4 23', 'Q1 24', 'Q2 24', 'Q3 24', 'Q4 24', 'Q1 25'],
            segmentRevenue: {
                datasets: [
                    {
                        label: 'Commercial Airplanes (BCA)',
                        data: [8.8, 8.1, 10.5, 8.6, 9.2, 8.5, 10.9, 8.3],
                        backgroundColor: CHART_COLORS.blue
                    },
                    {
                        label: 'Defense, Space & Security (BDS)',
                        data: [6.2, 6.3, 6.9, 6.5, 6.6, 6.4, 7.1, 6.8],
                        backgroundColor: CHART_COLORS.sky
                    },
                     {
                        label: 'Global Services (BGS)',
                        data: [4.7, 4.8, 4.8, 5.0, 5.1, 4.9, 5.1, 5.2],
                        backgroundColor: CHART_COLORS.gray
                    }
                ]
            }
        };

        let yearlyChart = null;
        let quarterlyChart = null;
        const yearlySelect = document.getElementById('yearlyMetricSelect');
        const quarterlySelect = document.getElementById('quarterlyMetricSelect');
        const yearlyCanvas = document.getElementById('yearlyFinancialChart').getContext('2d');
        const quarterlyCanvas = document.getElementById('quarterlyFinancialChart').getContext('2d');

        function createYearlyChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: [{
                        label: metricDetails.label,
                        data: metricDetails.data,
                        backgroundColor: metricDetails.color + 'BF',
                        borderColor: metricDetails.color,
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { y: { beginAtZero: false, title: { display: true, text: metricDetails.label.split('(')[1].replace(')','')} } },
                    plugins: { legend: { display: false } }
                }
            });
        }

        function createQuarterlyChart(canvas, existingChart, dataStore, metricKey) {
            if (existingChart) {
                existingChart.destroy();
            }
            const metricDetails = dataStore[metricKey];
            return new Chart(canvas, {
                type: 'bar',
                data: {
                    labels: dataStore.labels,
                    datasets: metricDetails.datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: { 
                        x: { stacked: true },
                        y: { stacked: true, title: { display: true, text: 'Revenue ($B)'} } 
                    },
                    plugins: { legend: { position: 'bottom' }, title: { display: true, text: 'Quarterly Revenue by Segment ($B)' } }
                }
            });
        }
        
        yearlySelect.addEventListener('change', (event) => {
            yearlyChart = createYearlyChart(yearlyCanvas, yearlyChart, yearlyDataStore, event.target.value);
        });

        quarterlySelect.addEventListener('change', (event) => {
            quarterlyChart = createQuarterlyChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, event.target.value);
        });

        // Initial chart renders
        yearlyChart = createYearlyChart(yearlyCanvas, yearlyChart, yearlyDataStore, 'netRevenue');
        quarterlyChart = createQuarterlyChart(quarterlyCanvas, quarterlyChart, quarterlyDataStore, 'segmentRevenue');

    </script>
</body>
</html>

